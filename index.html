<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>正在跳转</title>
  <script src="https://g.alicdn.com/dingding/open-develop/1.10.0/dingtalk.js"></script>
</head>
<body>
  <p>正在跳转中，请稍候...</p>
  <script>
    const pageUrl = location.href.split('#')[0];
    fetch(`http://localhost:3000/ding-sign?url=${encodeURIComponent(pageUrl)}`)
      .then(res => res.json())
      .then(config => {
        dd.config({
          agentId: config.agentId,
          corpId: config.corpId,
          timeStamp: config.timeStamp,
          nonceStr: config.nonceStr,
          signature: config.signature,
          jsApiList: ['openChatByConversationId']
        });
  
        dd.ready(function () {
          dd.openChatByConversationId({
            openConversationId: 'cid0mZabRF1nv7iJ6b14g2fCWyKAaQ7EQJBH0euT+f65Sg=', // 替换为实际的会话ID
            success: function () {
              console.log('打开成功');
            },
            fail: function (err) {
              console.error('打开失败', err);
            }
          });
        });
      });
  </script>
</body>
</html>
